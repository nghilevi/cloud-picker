(this["webpackJsonpcloud-picker"]=this["webpackJsonpcloud-picker"]||[]).push([[0],[,,,,,,,,,,,,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var o,i,c,r=n(1),a=n.n(r),s=n(6),u=n.n(s),d=n(2),l="https://api.aiven.io/v1/clouds";!function(e){e.Default="Default",e.Loading="Loading",e.Success="Success",e.Failure="Failure",e.Unavailable="Unavailable"}(o||(o={})),function(e){e.Error="Something went wrong",e.TryAgain="Please try again later!"}(i||(i={})),function(e){e.Default="The Prime Meridian (Greenwich) geolocation is used by default to find the nearest service cloud.",e.Loading="Fetching geolocation...",e.Success="The service cloud list is ranked dynamically based on the shortest distance to your coordination at:",e.Failure="We can not get your geolocation.",e.Unavailable="Geolocation is not available on your device!"}(c||(c={}));var j,g,b={Loading:"Fetching clouds... Please wait a few seconds ... Thank you!",Failure:"Data loaded failed"+i.TryAgain};!function(e){e.Selected="You selected:",e.Unselected="Please select cloud service in the list below filtering by Service Cloud Provider and Region."}(j||(j={})),function(e){e[e.lat=51.477928]="lat",e[e.lon=-.001545]="lon"}(g||(g={}));var v={description:"",name:"",provider:"",region:"",distance:NaN,latitude:NaN,longitude:NaN},f=(n(15),n(0)),h=function(e){var t=e.cloudsByRegionAndProvider,n=e.selectedCloud,o=e.onCloudClick;return Object(f.jsx)(f.Fragment,{children:t&&t.length>0?Object(f.jsx)("ol",{className:"clouds-list",children:t.map((function(e,t){return Object(f.jsx)("li",{children:Object(f.jsxs)("button",{"data-testid":"cloud-option",className:"clouds-list-item ".concat((null===n||void 0===n?void 0:n.description)===e.description?"selected":""),onClick:function(t){return o(e)},children:[Object(f.jsxs)("h3",{"data-testid":"cloud-name",children:[e.name," ",Object(f.jsxs)("span",{children:["\ud83d\udccd ~",e.distance," km"]})]}),Object(f.jsx)("p",{className:"cloud-description",children:e.description})]})},t)}))}):Object(f.jsx)(f.Fragment,{})})},O=(n(17),function(e){var t=e.providers,n=e.selectedCloudProvider,o=e.onProviderClick;return Object(f.jsxs)("div",{className:"providers",children:[Object(f.jsx)("h3",{children:"1. Select Cloud Provider"}),Object(f.jsx)("ul",{className:"providers-list",children:t.map((function(e,t){return Object(f.jsx)("li",{children:Object(f.jsx)("button",{"data-testid":"provider",name:e,className:"providers-list-item ".concat(n===e?"selected":""),onClick:function(){return o(e)},children:Object(f.jsx)("img",{src:"assets/logo/".concat(e,".png"),alt:e})})},t)}))})]})}),p=(n(18),function(e){var t=e.cloudRegionsByProvider,n=e.selectedCloudRegion,o=e.onRegionClick;return Object(f.jsxs)("div",{className:"regions",children:[Object(f.jsx)("h3",{children:"2. Select Cloud by Region"}),Object(f.jsx)("ul",{className:"regions-list",children:t.map((function(e,t){return Object(f.jsx)("li",{children:Object(f.jsx)("button",{"data-testid":"region",className:"regions-list-item ".concat(n===e?"selected":""),onClick:function(){return o(e)},children:e})},t)}))})]})}),x=(n(19),function(e){var t=e.region,n=t&&(t.search("Asia")>-1||t.search("Australia")>-1)?"Asia":t.search("America")>-1?"America":"Europe-Africa";return Object(f.jsx)("span",{className:"globe-icon",children:"Asia"===n?"\ud83c\udf0f":"America"===n?"\ud83c\udf0e":"\ud83c\udf0d"})}),C=function(e){var t=e.selectedCloud;return Object(f.jsx)(f.Fragment,{children:t?Object(f.jsxs)("p",{children:[j.Selected,Object(f.jsx)(x,{region:null===t||void 0===t?void 0:t.region}),null===t||void 0===t?void 0:t.description]}):Object(f.jsx)("p",{children:j.Unselected})})},m=function(e){var t=e.clouds,n=e.cloudRegionsByProvider,o=e.cloudsByRegionAndProvider,i=e.selectedCloud,c=e.selectedCloudProvider,r=e.selectedCloudRegion,a=e.onRegionClick,s=e.onCloudClick,u=e.onProviderClick;return Object(f.jsxs)("div",{children:[Object(f.jsx)(C,{selectedCloud:i}),Object(f.jsx)(O,{providers:t.providers,selectedCloudProvider:c,onProviderClick:u}),Object(f.jsx)(p,{cloudRegionsByProvider:n,selectedCloudRegion:r,onRegionClick:a}),Object(f.jsx)(h,{cloudsByRegionAndProvider:o,selectedCloud:i,onCloudClick:s})]})},S=function(e){var t=e.rawCloudsStatus;return Object(f.jsx)(f.Fragment,{children:function(){var e;return t===o.Loading?e=Object(f.jsx)("p",{"data-testid":"cloud-loading-status",children:b.Loading}):t===o.Failure&&(e=Object(f.jsx)("p",{"data-testid":"cloud-loading-status",children:b.Failure})),e}()})},y=function(e){var t=e.geolocationStatus,n=e.userLatitude,i=e.userLongitude;return Object(f.jsx)(f.Fragment,{children:function(e){var t,n=e.geolocationStatus,i=e.userLatitude,r=e.userLongitude;switch(n){case o.Loading:t=Object(f.jsx)("p",{"data-testid":"geo-loading-status",children:c.Loading});break;case o.Success:t=Object(f.jsxs)("p",{"data-testid":"geo-loading-status",children:[c.Success," ",i,", ",r]});break;case o.Unavailable:t=Object(f.jsxs)("p",{"data-testid":"geo-loading-status",children:[c.Unavailable," ",c.Default]});break;case o.Failure:t=Object(f.jsxs)("p",{"data-testid":"geo-loading-status",children:[c.Failure," ",c.Default]});break;default:t=Object(f.jsx)("p",{"data-testid":"geo-loading-status"})}return t}({geolocationStatus:t,userLatitude:n,userLongitude:i})})};var k=function(e){var t=e.userLatitude,n=e.userLongitude,i=e.clouds,c=e.geolocationStatus,a=e.rawCloudsStatus,s=Object(r.useState)([]),u=Object(d.a)(s,2),l=u[0],j=u[1],g=Object(r.useState)([]),b=Object(d.a)(g,2),v=b[0],h=b[1],O=Object(r.useState)(""),p=Object(d.a)(O,2),x=p[0],C=p[1],k=Object(r.useState)(""),L=Object(d.a)(k,2),N=L[0],P=L[1],R=Object(r.useState)(),F=Object(d.a)(R,2),w=F[0],A=F[1];Object(r.useEffect)((function(){i.providers.length>0&&""===x&&E(i,Object.keys(i)[0])}));var E=function(e,t){var n=e[t];C(t),j(n.regions),M(e,t,n.nearestRegion)},M=function(e,t,n){var o=e[t];P(n),h(o[n])};return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h1",{children:"Cloud Picker"}),Object(f.jsx)(y,{geolocationStatus:c,userLatitude:t,userLongitude:n}),a===o.Loading||a===o.Failure?Object(f.jsx)(S,{rawCloudsStatus:a}):c!==o.Loading?Object(f.jsx)(m,{"data-testid":"cloud-picker-options",clouds:i,cloudRegionsByProvider:l,cloudsByRegionAndProvider:v,selectedCloud:w,selectedCloudProvider:x,selectedCloudRegion:N,onProviderClick:function(e){E(i,e)},onRegionClick:function(e){M(i,x,e)},onCloudClick:function(e){A(e)}}):""]})},L=(n(20),n(7)),N=n(8),P=n(10),R=n(9),F=function(e){Object(P.a)(n,e);var t=Object(R.a)(n);function n(e){var o;return Object(L.a)(this,n),(o=t.call(this,e)).state={hasError:!1},o}return Object(N.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log(e,t)}},{key:"render",value:function(){return this.state.hasError?Object(f.jsxs)("p",{children:[i.Error," ",i.TryAgain]}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(a.a.Component),w=n(3),A=n(4),E=function(e,t){return e[t.provider]?e[t.provider][t.region]?e[t.provider][t.region].push(t):e[t.provider][t.region]=[]:e[t.provider]=Object(A.a)({nearestRegion:t.region},t.region,[t]),e},M=function(e,t){return e.distance-t.distance},D=function(e){var t=/-\s(.*?):/.exec(e);return t?t[1]:""},U=function(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"K";if("number"!==typeof e||"number"!==typeof t||"number"!==typeof n||"number"!==typeof o||"string"!==typeof i||-1===["K","N"].indexOf(i))return NaN;var c=Math.PI*e/180,r=Math.PI*n/180,a=t-o,s=Math.PI*a/180,u=Math.sin(c)*Math.sin(r)+Math.cos(c)*Math.cos(r)*Math.cos(s);return u=60*(u=180*(u=Math.acos(u))/Math.PI)*1.1515,"K"===i&&(u*=1.609344),"N"===i&&(u*=.8684),u},_=function(e,t){var n=e.map(function(e){return function(t){return t&&"object"===typeof t?{distance:Math.round(U(t.geo_latitude,t.geo_longitude,e.lat,e.lon,"K")),provider:D(t.cloud_description),region:(n=t.geo_region,"string"===typeof n?n.split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" "):""),description:t.cloud_description||"",name:t.cloud_name||"",latitude:isNaN(t.geo_latitude)?NaN:t.geo_latitude,longitude:isNaN(t.geo_longitude)?NaN:t.geo_longitude}:v;var n}}(t)).sort(M).reduce(E,{});return function(e){var t=Object(w.a)({},e);return t.providers=Object.keys(t).sort().map((function(e){return Object.keys(t[e]).forEach((function(n){0===t[e][n].length&&delete t[e][n]})),t[e].regions=Object.keys(t[e]).sort().filter((function(e){return"nearestRegion"!==e})),e})),t}(Object(w.a)({},n))},B=function(){var e=Object(r.useState)(g.lat),t=Object(d.a)(e,2),n=t[0],i=t[1],a=Object(r.useState)(g.lon),s=Object(d.a)(a,2),u=s[0],l=s[1],j=Object(r.useState)(o.Default),b=Object(d.a)(j,2),v=b[0],f=b[1],h=Object(r.useState)(),O=Object(d.a)(h,2),p=O[0],x=O[1];return Object(r.useEffect)((function(){f(o.Loading),navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){i(e.coords.latitude),l(e.coords.longitude),f(o.Success)}),(function(e){f(o.Failure),x(e)})):(f(o.Unavailable),x(c.Unavailable))}),[]),{userLatitude:n,userLongitude:u,geolocationStatus:v,geolocationError:p}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=Object(r.useState)([]),n=Object(d.a)(t,2),i=n[0],c=n[1],a=Object(r.useState)(o.Default),s=Object(d.a)(a,2),u=s[0],j=s[1];return Object(r.useEffect)((function(){j(o.Loading),fetch(e).then((function(e){return e.json()})).then((function(e){var t=e.clouds;j(o.Success),c(t)})).catch((function(){j(o.Failure),c([])}))}),[e]),{rawClouds:i,rawCloudsStatus:u}},I=function(){var e=T(),t=e.rawClouds,n=e.rawCloudsStatus,i=B(),c=i.userLatitude,a=i.userLongitude,s=i.geolocationStatus,u=Object(r.useState)({providers:[]}),l=Object(d.a)(u,2),j=l[0],g=l[1];return Object(r.useEffect)((function(){if(n===o.Success&&s!==o.Loading){var e=_(t,{lat:c,lon:a});g(e)}}),[c,a,n,s,t]),{userLatitude:c,userLongitude:a,rawCloudsStatus:n,geolocationStatus:s,clouds:j}},K=function(){var e=I(),t=e.userLatitude,n=e.userLongitude,o=e.clouds,i=e.geolocationStatus,c=e.rawCloudsStatus;return Object(f.jsx)("div",{className:"app",children:Object(f.jsx)(F,{children:Object(f.jsx)(k,{userLatitude:t,userLongitude:n,clouds:o,geolocationStatus:i,rawCloudsStatus:c})})})};u.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(K,{})}),document.getElementById("root"))}],[[21,1,2]]]);
//# sourceMappingURL=main.3b4b8725.chunk.js.map